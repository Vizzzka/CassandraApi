C:\Users\usach\Downloads\amazon_reviews_us_Digital_Ebook_Purchase_v1_01_1_7.tsv

CREATE KEYSPACE reviews
     WITH replication = {'class': 'SimpleStrategy', 'replication_factor' : 3};

t1
CREATE TABLE reviews.reviews_by_product_id (
product_id text,
review_id text,
star_rating int,
PRIMARY KEY ((product_id), review_id)) WITH comment = 'Q1'
AND CLUSTERING ORDER BY (review_id ASC);

t2
CREATE TABLE reviews.reviews_by_star_rating_and_product_id (
product_id text,
review_id text,
star_rating int,
PRIMARY KEY ((product_id), star_rating, review_id)) WITH comment = 'Q2'
AND CLUSTERING ORDER BY (star_rating ASC);

t3
CREATE TABLE reviews.reviews_by_customer_id (
customer_id int,
review_id text,
PRIMARY KEY ((customer_id), review_id)) WITH comment = 'Q3'
AND CLUSTERING ORDER BY (review_id ASC);

t4
CREATE TABLE reviews.item_reviews_by_date (
year_month text,
review_date date,
product_id text,
review_id text,
PRIMARY KEY ((year_month), review_date, product_id, review_id)) WITH comment = 'Q4'
AND CLUSTERING ORDER BY (review_date ASC);


t5
CREATE TABLE reviews.customer_reviews_by_date (
year_month text,
verified_purchase text,
review_date date,
customer_id int,
review_id text,
PRIMARY KEY ((year_month), verified_purchase, review_date, customer_id, review_id)) WITH comment = 'Q5';


t7-t8
CREATE TABLE reviews.customers_reviews_by_date_and_star_rating (
year_month text,
star_rating int,
review_date date,
customer_id int,
review_id text,
PRIMARY KEY ((year_month), star_rating, review_date, customer_id, review_id)) WITH comment = 'Q7-Q8';


Q1
SELECT review_id FROM reviews.reviews_by_product_id WHERE product_id = 'B00EFDZ288';

Q2
SELECT JSON review_id FROM reviews.reviews_by_star_rating_and_product_id
WHERE product_id = 'B00EFDZ288' AND star_rating = 5;

Q3
SELECT review_id FROM reviews.reviews_by_customer_id
WHERE customer_id = 36554234;

Q4
SELECT  product_id FROM reviews.item_reviews_by_date
WHERE year_month = '2013-09' AND review_date >= '2013-08-01' AND review_date <= '2013-10-01';


Q5
SELECT  customer_id FROM reviews.customer_reviews_by_date
WHERE year_month = '2013-09' AND review_date >= '2013-08-01'
AND review_date <= '2013-10-01' AND verified_purchase = 'Y';

Q7-Q8
SELECT customer_id FROM reviews.customers_reviews_by_date_and_star_rating
WHERE year_month = '2013-09' AND star_rating = 5 AND review_date <= '2013-10-01' AND review_date >= '2013-08-01';
